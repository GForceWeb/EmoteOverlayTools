import{g as x,h as A}from"./main-ROiFbYVS.js";import{g as d}from"./index-Brfk6Bdo.js";import"./defaultConfig-CxZCM2FP.js";const y={L1:[[0,0,1,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],L2:[[1,0,0,0],[1,0,0,0],[1,1,0,0],[0,0,0,0]],L3:[[1,1,1,0],[1,0,0,0],[0,0,0,0],[0,0,0,0]],L4:[[1,1,0,0],[0,1,0,0],[0,1,0,0],[0,0,0,0]],P1:[[1,0,0,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],P2:[[1,1,0,0],[1,0,0,0],[1,0,0,0],[0,0,0,0]],P3:[[1,1,1,0],[0,0,1,0],[0,0,0,0],[0,0,0,0]],P4:[[0,1,0,0],[0,1,0,0],[1,1,0,0],[0,0,0,0]],Z1:[[1,1,0,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],Z2:[[0,1,0,0],[1,1,0,0],[1,0,0,0],[0,0,0,0]],Z3:[[1,1,0,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]],Z4:[[0,1,0,0],[1,1,0,0],[1,0,0,0],[0,0,0,0]],S1:[[0,1,1,0],[1,1,0,0],[0,0,0,0],[0,0,0,0]],S2:[[1,0,0,0],[1,1,0,0],[0,1,0,0],[0,0,0,0]],S3:[[0,1,1,0],[1,1,0,0],[0,0,0,0],[0,0,0,0]],S4:[[1,0,0,0],[1,1,0,0],[0,1,0,0],[0,0,0,0]],T1:[[0,1,0,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],T2:[[1,0,0,0],[1,1,0,0],[1,0,0,0],[0,0,0,0]],T3:[[1,1,1,0],[0,1,0,0],[0,0,0,0],[0,0,0,0]],T4:[[0,1,0,0],[1,1,0,0],[0,1,0,0],[0,0,0,0]],I1:[[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0]],I2:[[1,1,1,1],[0,0,0,0],[0,0,0,0],[0,0,0,0]],I3:[[1,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,0,0]],I4:[[1,1,1,1],[0,0,0,0],[0,0,0,0],[0,0,0,0]],Q1:[[1,1,0,0],[1,1,0,0],[0,0,0,0],[0,0,0,0]],Q2:[[1,1,0,0],[1,1,0,0],[0,0,0,0],[0,0,0,0]],Q3:[[1,1,0,0],[1,1,0,0],[0,0,0,0],[0,0,0,0]],Q4:[[1,1,0,0],[1,1,0,0],[0,0,0,0],[0,0,0,0]]};function F(p,w=20,C=100){let s=Array(20).fill(null).map(()=>Array(10).fill(null));const m=window.innerHeight,g=window.innerWidth,_=m/1.3,W=g/4,P=Math.min(_/20,W/10),c=Math.max(20,Math.min(60,P));console.log(`Tetris animation: Window ${g}x${m}, Cell size: ${c}px`);const l=document.createElement("div");l.id="tetris-grid-"+x.divnumber++,l.className="tetris-grid",x.warp.appendChild(l),d.set(l,{position:"absolute",left:"50%",bottom:c+"px",transform:"translateX(-50%)",width:10*c+"px",height:20*c+"px",display:"grid",gridTemplateColumns:`repeat(10, ${c}px)`,gridTemplateRows:`repeat(20, ${c}px)`,gap:"0px"});for(let t=0;t<20;t++)for(let e=0;e<10;e++){const o=document.createElement("div");o.className="tetris-cell",o.id=`tetris-${l.id}-${t}-${e}`,l.appendChild(o),d.set(o,{width:c+"px",height:c+"px",backgroundColor:"transparent"})}const h=Object.keys(y).filter(t=>t.endsWith("1")).map(t=>t[0]);let i=null,a={x:0,y:0},G=0,f=0;function $(){const t=h[Math.floor(Math.random()*h.length)],e=Math.floor(Math.random()*4)+1;return y[`${t}${e}`]}function E(t){let e=0;for(let o=0;o<4;o++)for(let n=0;n<4;n++)t[n][o]&&(e=Math.max(e,o+1));return e}function H(t,e,o){if(e>=0&&e<20&&t>=0&&t<10){const n=document.getElementById(`tetris-${l.id}-${e}-${t}`);n&&(o?d.set(n,{backgroundImage:`url(${o})`,backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"}):d.set(n,{clearProps:"background"}))}}function D(){for(let t=0;t<20;t++)for(let e=0;e<10;e++)H(e,t,s[t][e]);if(i){const t=p[f];for(let e=0;e<4;e++)for(let o=0;o<4;o++)i[e][o]&&a.y+e>=0&&H(a.x+o,a.y+e,t)}}function b(t,e){for(let o=0;o<4;o++)for(let n=0;n<4;n++)if(t[o][n]){const r=e.x+n,u=e.y+o;if(r<0||r>=10||u>=20||u>=0&&s[u][r]!==null)return!1}return!0}function k(t,e){const o=p[f];f=(f+1)%p.length;for(let n=0;n<4;n++)for(let r=0;r<4;r++)t[n][r]&&e.y+n>=0&&(s[e.y+n][e.x+r]=o);S()}function S(){const t=[];for(let e=0;e<20;e++)s[e].every(o=>o!==null)&&t.push(e);t.length>0&&M(t)}function M(t){const e=i,o={...a};i=null;const n=[];t.forEach(u=>{for(let I=0;I<10;I++){const R=document.getElementById(`tetris-${l.id}-${u}-${I}`);R&&n.push(R)}});const r=d.timeline({onComplete:()=>{z(t),i=e,a=o,D()}});r.to(n,{backgroundColor:"white",duration:.1}).to(n,{backgroundColor:"transparent",duration:.1}).to(n,{backgroundColor:"white",duration:.1}).to(n,{backgroundColor:"transparent",duration:.1}).to(n,{backgroundColor:"white",duration:.1}),r.to(n,{scale:1.5,opacity:0,duration:.2,stagger:.02,ease:"power1.out"})}function z(t){t.sort((e,o)=>o-e),t.forEach(e=>{s.splice(e,1),s.unshift(Array(10).fill(null))})}function v(){i=$();const t=E(i);a={x:Math.floor(Math.random()*(10-t+1)),y:-4},G++}function T(){i||v();const t={...a,y:a.y+1};i&&b(i,t)?a=t:i&&(k(i,a),i=null),D(),G<w?setTimeout(T,C):d.to(l,{opacity:0,duration:1,ease:"power2.out",onComplete:()=>{A.removeelement(l.id)}})}T()}export{F as tetris};
